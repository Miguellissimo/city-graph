!function(){function a(){navigator.geolocation.getCurrentPosition(function(a){var n=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);c.setCenter(n)})}function n(a){GoogleMapsFunctions.getCoordinatesFromCityName(a,function(n){var t=n.lat,o=n.lng;InstagramFunctions.getRecentImages(a,u,t,o,l),c.setCenter(new google.maps.LatLng(t,o)),c.setZoom(10)})}function t(a,n,t){function o(a){return math.matrix([[math.cos(a),math.sin(a)],[-math.sin(a),math.cos(a)]])}for(var e=[.3,0],g=math.PI/(t/2),i=[],l=0;l<2*math.PI;l+=g){var r=math.multiply(o(l),e);r._data[0]=r._data[0]/2,i.push(math.add(r,[a,n]))}return i}function o(){if(h.length>0){for(var a=0;a<h.length;a++)h[a].setMap(null);h=[]}}function e(){if(m.length>0){for(var a=0;a<m.length;a++)m[a].setMap(null);m=[]}}function g(){var a=this.labelContent;e(),n(a)}function i(){var a=this;if(h.length>1){o(),a.setMap(c),h.push(a),a.setPosition(new google.maps.LatLng(a.originalLat,a.originalLng));for(var n=a.hashTags,e=math.min(n.length,20),i=t(a.originalLat,a.originalLng,e),l=0;l<i.length;l++){var a=new MarkerWithLabel({position:new google.maps.LatLng(i[l]._data[0],i[l]._data[1]),map:c,draggable:!1,raiseOnDrag:!1,labelContent:n[l],labelAnchor:new google.maps.Point(3,30),labelClass:"hashTaglabels",labelInBackground:!1});a.hashTag=n[l],m.push(a),a.addListener("click",g)}}else window.open(a.postUrl)}function l(a,n,e){o();var g=t(n,e,u);console.log(g);for(var l=0;l<g.length;l++){var r=new google.maps.Marker({position:new google.maps.LatLng(g[l]._data[0],g[l]._data[1]),map:c,icon:a[l][1]});h.push(r),r.postUrl=a[l][0],r.thumbnailUrl=a[l][1],r.imageUrl=a[l][2],r.hashTags=a[l][3],r.originalLat=n,r.originalLng=e,r.addListener("click",i)}}function r(a){var n=a.latLng.lat(),t=a.latLng.lng();c.setCenter(a.latLng),c.setZoom(10),GoogleMapsFunctions.getCityNameFromCoordinates(n,t,function(a){console.log(a),InstagramFunctions.getRecentImages(a,u,n,t,l)})}function s(){var n={center:new google.maps.LatLng(0,0),zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP},t=document.getElementById("googleMap");c=new google.maps.Map(t,n),a(),c.addListener("zoom_changed",o),google.maps.event.addListener(c,"click",r);var e=$(window).height()-$("header").height()-$(".searchControls").height();$("#googleMap").height(e)}var c,h=[],m=[],u=8;$(document).ready(function(){s(),$("#searchButton").click(function(){var a=$("#searchInput").val();console.log(a),n(a)})})}();