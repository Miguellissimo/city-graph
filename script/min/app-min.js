!function(){function a(a,t){u.push({lat:a,lng:t}),d.setMap(null),d=new google.maps.Polyline({path:u,geodesic:!0,strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:2}),d.setMap(h)}function t(){navigator.geolocation.getCurrentPosition(function(t){var n=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);a(t.coords.latitude,t.coords.longitude),h.setCenter(n)})}function n(a){GoogleMapsFunctions.getCoordinatesFromCityName(a,function(t){var n=t.lat,e=t.lng;InstagramFunctions.getRecentImages(a,f,n,e,s),h.setCenter(new google.maps.LatLng(n,e)),h.setZoom(10)})}function e(a,t,n){function e(a){return math.matrix([[math.cos(a),math.sin(a)],[-math.sin(a),math.cos(a)]])}for(var o=[.3,0],g=math.PI/(n/2),l=[],i=0;i<2*math.PI;i+=g){var s=math.multiply(e(i),o);s._data[0]=s._data[0]/2,l.push(math.add(s,[a,t]))}return l}function o(){if(p.length>0){for(var a=0;a<p.length;a++)p[a].setMap(null);p=[]}}function g(){if(m.length>0){for(var a=0;a<m.length;a++)m[a].setMap(null);m=[]}}function l(){var a=this.labelContent;g(),$("#searchInput").val(a),n(a)}function i(){var a=this;if(p.length>1){o(),a.setMap(h),p.push(a),a.setPosition(new google.maps.LatLng(a.originalLat,a.originalLng));for(var t=a.hashTags,n=math.min(t.length,20),g=e(a.originalLat,a.originalLng,n),i=0;i<g.length;i++){var a=new MarkerWithLabel({position:new google.maps.LatLng(g[i]._data[0],g[i]._data[1]),map:h,draggable:!1,raiseOnDrag:!1,labelContent:t[i],labelAnchor:new google.maps.Point(3,30),labelClass:"hashTaglabels",labelInBackground:!1});a.hashTag=t[i],m.push(a),a.addListener("click",l)}}else window.open(a.postUrl)}function s(t,n,g){o();var l=e(n,g,f);console.log(l);for(var s=0;s<l.length;s++){var r=new google.maps.Marker({position:new google.maps.LatLng(l[s]._data[0],l[s]._data[1]),map:h,icon:t[s][1]});p.push(r),r.postUrl=t[s][0],r.thumbnailUrl=t[s][1],r.imageUrl=t[s][2],r.hashTags=t[s][3],r.originalLat=n,r.originalLng=g,r.addListener("click",i)}a(n,g)}function r(a){var t=a.latLng.lat(),n=a.latLng.lng();h.setCenter(a.latLng),h.setZoom(10),GoogleMapsFunctions.getCityNameFromCoordinates(t,n,function(a){console.log(a),$("#searchInput").val(a),InstagramFunctions.getRecentImages(a,f,t,n,s)})}function c(){var a={center:new google.maps.LatLng(0,0),zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP},n=document.getElementById("googleMap");h=new google.maps.Map(n,a),t(),h.addListener("zoom_changed",o),google.maps.event.addListener(h,"click",r);var e=$(window).height()-$("header").height()-$(".searchControls").height();$("#googleMap").height(e)}var h,p=[],m=[],u=[],d,f=8;$(document).ready(function(){c(),d=new google.maps.Polyline({path:u,geodesic:!0,strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:2}),d.setMap(h),$("#searchButton").click(function(){var a=$("#searchInput").val();console.log(a),n(a)})})}();